Index: views/admin/login.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?php\r\nif (isset($_SESSION['admin_name'])) {\r\n    header('Location: '. HOME_ADMIN_URL);\r\n    exit();\r\n}\r\n?>\r\n<!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n    <meta charset=\"utf-8\">\r\n    <meta content=\"width=device-width, initial-scale=1.0\" name=\"viewport\">\r\n\r\n    <title>Đăng nhập</title>\r\n    <link href=\"./assets/img/logo.png\" rel=\"icon\">\r\n    <!-- Favicons -->\r\n    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\"\r\n          integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\">\r\n    <link rel=\"stylesheet\" href=\"https://unpkg.com/bs-brain@2.0.4/components/logins/login-9/assets/css/login-9.css\">\r\n    <link href=\"assets/css/style.css\" rel=\"stylesheet\">\r\n    <link href=\"assets/vendor/fontawesome-free/css/all.css\" rel=\"stylesheet\">\r\n\r\n    <style>\r\n        .password-toggle {\r\n            cursor: pointer;\r\n            position: absolute;\r\n            right: 10px;\r\n            top: 50%;\r\n            transform: translateY(-50%);\r\n        }\r\n\r\n        .error-message {\r\n            color: red;\r\n            font-size: 0.8rem;\r\n            margin-top: 5px;\r\n        }\r\n\r\n        .invalid-input {\r\n            border-color: red;\r\n        }\r\n\r\n    </style>\r\n</head>\r\n<body style=\"background-color: #1f5d60; overflow-y: hidden \">\r\n<div id=\"loading-spinner\" style=\"text-align: center;line-height:700px;position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 1050; display: flex; align-items: center; justify-content: center;\">\r\n    <div class=\"spinner-border\" style=\"width: 3rem; height: 3rem;\" role=\"status\">\r\n        <span class=\"sr-only\">Loading...</span>\r\n    </div>\r\n</div>\r\n<!-- Login 9 - Bootstrap Brain Component -->\r\n<section class=\"py-5 py-md-5 py-xl-8 mt-1\" style=\"margin-top: 85px!important;\">\r\n    <div class=\"container\">\r\n        <div class=\"row gy-4 align-items-center\">\r\n            <div class=\"col-12 col-md-6 col-xl-7\">\r\n                <div class=\"d-flex justify-content-center\" style=\"background-color: #1F5D60FF; color: white\">\r\n                    <div class=\"col-12 col-xl-9\">\r\n                        <a href=\"<?php echo HOME_ADMIN_URL ?>\"\r\n                           class=\"logo me-auto\">\r\n                            <img class=\"img-fluid rounded mb-4\" loading=\"lazy\" src=\"assets/img/Medicare.png\" width=\"345\"\r\n                                 alt=\"BootstrapBrain Logo\">\r\n                        </a>\r\n                        <hr class=\"border-primary-subtle mb-4\">\r\n                        <h2 class=\"h1 mb-4\">Chào mừng đến với Medicare.</h2>\r\n                        <p class=\"lead mb-5\">Chúng tôi rất vui được chăm sóc sức khỏe của quý vị. Tại đây, chúng tôi cam\r\n                            kết cung cấp dịch vụ y tế chất lượng, chu đáo và chuyên nghiệp nhất để mang lại sự an tâm và\r\n                            hài lòng cho quý khách.</p>\r\n                        <div class=\"text-endx\">\r\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"48\" height=\"48\" fill=\"currentColor\"\r\n                                 class=\"bi bi-grip-horizontal\" viewBox=\"0 0 16 16\">\r\n                                <path d=\"M2 8a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm0-3a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm3 3a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm0-3a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm3 3a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm0-3a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm3 3a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm0-3a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm3 3a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm0-3a1 1 0 1 1 0 2 1 1 0 0 1 0-2z\"/>\r\n                            </svg>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"col-12 col-md-6 col-xl-5\">\r\n                <div class=\"card border-0 rounded-4\">\r\n                    <div class=\"card-body p-3 p-md-4 p-xl-4\">\r\n                        <div class=\"row mb-3\">\r\n                            <div class=\"col-12\">\r\n                                <div>\r\n                                    <h3>Đăng Nhập Trang Quản Trị</h3>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <form method=\"post\" onsubmit=\"return false;\">\r\n                            <div class=\"row gy-3 overflow-hidden\">\r\n                                <div class=\"col-12\">\r\n                                    <div class=\"form-floating mb-2\">\r\n                                        <input type=\"tel\" class=\"form-control\" name=\"phone\" id=\"phone\"\r\n                                               placeholder=\"name@example.com\" required>\r\n                                        <label for=\"phone\" class=\"form-label\">Số điện thoại</label>\r\n                                    </div>\r\n                                </div>\r\n                                <div class=\"col-12\">\r\n                                    <div class=\"form-floating mb-2\">\r\n                                        <input type=\"password\" class=\"form-control\" name=\"password\" id=\"password\"\r\n                                               value=\"\" placeholder=\"Password\" required>\r\n                                        <label for=\"password\" class=\"form-label\">Mật khẩu</label>\r\n                                        <i class=\"fas fa-eye password-toggle\" id=\"togglePassword\"\r\n                                           style=\"position: absolute; right: 10px; top: 50%; transform: translateY(-50%);\r\n                                           cursor: pointer;\"></i>\r\n                                    </div>\r\n                                </div>\r\n                                <div class=\"col-12\">\r\n                                    <span id=\"login-false\"></span>\r\n                                </div>\r\n                                <div class=\"col-12 mt-4\">\r\n                                    <div class=\"d-grid\">\r\n                                        <button id=\"loginButton\"\r\n                                                class=\"btn btn-lg\" style=\"background-color: #1F5D60FF; color: white\"\r\n                                                type=\"submit\">Đăng nhập ngay\r\n                                        </button>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </form>\r\n                        <div class=\"row\">\r\n                            <div class=\"col-12\">\r\n                                <div class=\"d-flex gap-2 gap-md-4 flex-column flex-md-row justify-content-md-end mt-3\">\r\n                                    <a href=\"#!\" data-bs-toggle=\"modal\" data-bs-target=\"#exampleModal\"\r\n                                    style=\"color: #1F5D60FF\">Quên mật khẩu</a>\r\n                                </div>\r\n                            </div>\r\n                            <div class=\"row mt-3\">\r\n                                <div class=\"col-12\">\r\n                                    <a href=\"<?php echo LOGIN_CLIENT_URL ?>\"\r\n                                       style=\"color: #1F5D60FF\">Đăng nhập người dùng\r\n                                        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" style=\"fill: rgba(31, 93, 96, 1);transform: ;msFilter:;\">\r\n                                            <path d=\"m13.061 4.939-2.122 2.122L15.879 12l-4.94 4.939 2.122 2.122L20.121 12z\"></path>\r\n                                            <path d=\"M6.061 19.061 13.121 12l-7.06-7.061-2.122 2.122L8.879 12l-4.94 4.939z\"></path>\r\n                                        </svg>\r\n                                    </a>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div id=\"toast\" class=\"toast\">Thông báo ở đây!</div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</section>\r\n<!-- Modal -->\r\n<div class=\"modal fade\" id=\"exampleModal\" tabindex=\"-1\" aria-labelledby=\"exampleModalLabel\" aria-hidden=\"true\">\r\n    <div class=\"modal-dialog\">\r\n        <div class=\"modal-content\">\r\n            <div class=\"modal-header\">\r\n                <h1 class=\"modal-title fs-5\" id=\"exampleModalLabel\">Thông báo</h1>\r\n                <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n            </div>\r\n            <div class=\"modal-body\">\r\n                Hãy liên hệ quản trị viên của bạn để được cấp lại mật khẩu\r\n            </div>\r\n            <div class=\"modal-footer\">\r\n                <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Đóng</button>\r\n\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n<script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js\"\r\n        integrity=\"sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz\"\r\n        crossorigin=\"anonymous\"></script>\r\n<script src=\"<?php echo BASE_URL ?>/assets/js/toast/use-bootstrap-toaster.min.js\"></script>\r\n<script src=\"https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js\"></script>\r\n<script src=\"<?php echo BASE_URL ?>/views/admin/assets/js/functions.js\"></script>\r\n\r\n<script>\r\n    document.addEventListener('DOMContentLoaded', function () {\r\n        document.getElementById('loading-spinner').style.display = 'none';\r\n        \r\n        var inputs = document.querySelectorAll('.form-control');\r\n\r\n        inputs.forEach(function (input) {\r\n            input.addEventListener('input', function () {\r\n                // Xóa thông báo lỗi nếu có\r\n                var errorMessage = input.parentElement.querySelector('.error-message');\r\n                if (errorMessage) {\r\n                    errorMessage.remove();\r\n                }\r\n                // Xóa viền đỏ\r\n                input.classList.remove('invalid-input');\r\n            });\r\n        });\r\n\r\n        document.getElementById('loginButton').addEventListener('click', validateAndSubmit);\r\n\r\n        document.getElementById('togglePassword').addEventListener('click', function (e) {\r\n            const passwordInput = document.getElementById('password');\r\n            const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';\r\n            passwordInput.setAttribute('type', type);\r\n            this.classList.toggle('fa-eye-slash');\r\n        });\r\n\r\n    });\r\n\r\n    function validateAndSubmit() {\r\n        var isValid = true;\r\n        var formData = new FormData();\r\n        var inputs = document.querySelectorAll('.form-control');\r\n\r\n        // Xóa các thông báo lỗi trước đó\r\n        document.querySelectorAll('.error-message').forEach(function (message) {\r\n            message.remove();\r\n        });\r\n\r\n        inputs.forEach(function (input) {\r\n            var error = null;\r\n            if (!input.value) {\r\n                error = 'Trường này không được để trống';\r\n            } else if (input.name === 'phone' && !/^\\d{10}$/.test(input.value)) {\r\n                error = 'Số điện thoại phải là 10 chữ số';\r\n            }\r\n\r\n            if (error) {\r\n                var errorMessage = document.createElement('div');\r\n                errorMessage.classList.add('error-message');\r\n                errorMessage.textContent = error;\r\n                input.classList.add('invalid-input');\r\n                input.parentElement.appendChild(errorMessage);\r\n                isValid = false;\r\n            } else {\r\n                formData.append(input.name, input.value);\r\n                input.classList.remove('invalid-input');\r\n            }\r\n        });\r\n\r\n        if (isValid) {\r\n            document.getElementById('loading-spinner').style.display = 'block';\r\n            $.ajax({\r\n                url: '<?php echo BASE_URL ?>/index.php?controller=auth&action=processLoginAdmin',\r\n                type: 'POST',\r\n                data: formData,\r\n                contentType: false, // Không set contentType\r\n                processData: false, // Không xử lý dữ liệu\r\n                success: function(response) {\r\n                    console.log(response);\r\n                    if(response['success'] === true) {\r\n                        var url = buildUrl('home', 'home_admin');\r\n                        success_toast(url);\r\n                    } else {\r\n                        inputs.forEach(function (input) {\r\n                            input.classList.add('invalid-input');\r\n                            isValid = false;\r\n                        });\r\n                        failed_toast(response['message'])\r\n                    }\r\n                },\r\n                error: function() {\r\n                    alert('Có lỗi xảy ra, vui lòng thử lại.');\r\n                },\r\n                complete: function() {\r\n                    $(\"#loading-spinner\").hide(); // Ẩn spinner khi yêu cầu hoàn thành\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    function success_toast(redirectUrl) {\r\n        toast({\r\n            classes: `text-bg-success border-0`,\r\n            body: `\r\n          <div class=\"d-flex w-100\" data-bs-theme=\"dark\">\r\n            <div class=\"flex-grow-1\">\r\n              Đăng nhập thành công !\r\n            </div>\r\n            <button type=\"button\" class=\"btn-close flex-shrink-0\" data-bs-dismiss=\"toast\" aria-label=\"Close\"></button>\r\n          </div>`,\r\n            autohide: true,\r\n            delay: 2000  // Thời gian hiển thị toast là 5000ms (5 giây)\r\n        });\r\n\r\n        // Đợi DOM cập nhật\r\n        setTimeout(() => {\r\n            // Lấy phần tử toast mới nhất\r\n            var toastElement = document.querySelector('.toast.show');\r\n            if (toastElement) {\r\n                var bsToast = new bootstrap.Toast(toastElement); // Khởi tạo lại đối tượng Toast nếu cần\r\n                toastElement.addEventListener('hidden.bs.toast', function () {\r\n                    window.location.href = redirectUrl; // Sử dụng URL được truyền vào\r\n                });\r\n            }\r\n        }, 100);\r\n    }\r\n\r\n    function failed_toast(message) {\r\n        toast({\r\n            classes: `text-bg-danger border-0`,\r\n            body: `\r\n              <div class=\"d-flex w-100\" data-bs-theme=\"dark\">\r\n                <div class=\"flex-grow-1\">\r\n                  ${message}\r\n                </div>\r\n                <button type=\"button\" class=\"btn-close flex-shrink-0\" data-bs-dismiss=\"toast\" aria-label=\"Close\"></button>\r\n              </div>`,\r\n        })\r\n    }\r\n</script>\r\n</body>\r\n</html>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/views/admin/login.php b/views/admin/login.php
--- a/views/admin/login.php	(revision a2a6c48be166dba10eb65bfeb210bf4d3634a9e4)
+++ b/views/admin/login.php	(date 1718756274321)
@@ -236,8 +236,7 @@
                 success: function(response) {
                     console.log(response);
                     if(response['success'] === true) {
-                        var url = buildUrl('home', 'home_admin');
-                        success_toast(url);
+                        success_toast('<?php echo HOME_ADMIN_URL ?>');
                     } else {
                         inputs.forEach(function (input) {
                             input.classList.add('invalid-input');
Index: views/admin/appointments.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?php\r\nsession_start();\r\nif (!isset($_SESSION['admin_name'])) {\r\n    header('Location: '. NOT_FOUND_URL);\r\n    exit();\r\n}\r\n?>\r\n<!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n    <meta charset=\"utf-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no\">\r\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\r\n    <meta name=\"description\" content=\"\">\r\n    <meta name=\"author\" content=\"\">\r\n    <link href=\"assets/img/logo.png\" rel=\"icon\">\r\n    <title>Danh sách lịch khám</title>\r\n    <?php include 'import-link-tag.php' ?>\r\n    <style>\r\n        #btn-action:focus {\r\n            outline: none;\r\n            border: none;\r\n            box-shadow: none;\r\n        }\r\n        .col-2-5 {\r\n            flex: 0 0 20.83333%;\r\n            max-width: 20.83333%;\r\n        }\r\n    </style>\r\n</head>\r\n<body>\r\n<div class=\"be-wrapper\">\r\n    <!--    Navbar-->\r\n    <?php include 'navbar.php' ?>\r\n    <!--    left sidebar-->\r\n    <?php include 'sidebar.php' ?>\r\n    <div class=\"be-content\">\r\n        <div class=\"page-head\">\r\n            <h2 class=\"page-head-title\">Danh sách lịch khám</h2>\r\n            <nav aria-label=\"breadcrumb\" role=\"navigation\">\r\n                <ol class=\"breadcrumb page-head-nav\">\r\n                    <li class=\"breadcrumb-item\"><a href=\"index.php\">Trang chủ</a></li>\r\n                    <li class=\"breadcrumb-item\">Quán lý đặt lịch</li>\r\n                    <li class=\"breadcrumb-item active\">Danh sách lịch khám</li>\r\n                </ol>\r\n            </nav>\r\n        </div>\r\n        <div class=\"main-content container-fluid\" style=\"margin-top: -30px\">\r\n            <div class=\"row\">\r\n                <div class=\"col-md-12\">\r\n                    <div class=\"card card-table\">\r\n                        <div class=\"row table-filters-container\">\r\n                            <div class=\"col-2-5 table-filters pb-0\">\r\n                                <div class=\"filter-container\">\r\n                                    <label class=\"control-label table-filter-title\">Lọc chuyên khoa:</label>\r\n                                    <form>\r\n                                        <select class=\"select2\" name=\"specialty\">\r\n                                            <option value=\"All\" <?php echo ($specialtySelected == 'All' ? 'selected' : ''); ?>>Tất cả chuyên khoa</option>\r\n                                            <?php\r\n                                            foreach ($listSpecialties as $specialty) {\r\n                                                // Kiểm tra nếu id của chuyên khoa hiện tại trùng với $specialtySelected\r\n                                                $selected = ($specialty['specialty_id'] == $specialtySelected) ? 'selected' : '';\r\n                                                echo \"<option value='\" . htmlspecialchars($specialty['specialty_id']) . \"' $selected>\" . htmlspecialchars($specialty['name']) . \"</option>\";\r\n                                            }\r\n                                            ?>\r\n                                        </select>\r\n                                    </form>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div class=\"col-2-5 table-filters pb-0\">\r\n                                <div class=\"filter-container\">\r\n                                    <label class=\"control-label table-filter-title\">Lọc bác sĩ:</label>\r\n                                    <form>\r\n                                        <select class=\"select2\" name=\"doctor\">\r\n                                            <option value=\"All\" <?php echo ($doctorSelected == 'All' ? 'selected' : ''); ?>>Tất cả bác sĩ</option>\r\n                                            <?php\r\n                                            foreach ($listDoctors as $doctor) {\r\n                                                // Kiểm tra nếu id của bác sĩ hiện tại trùng với $doctor_selected\r\n                                                $selected = ($doctor['id'] == $doctorSelected) ? 'selected' : '';\r\n                                                echo \"<option value='\" . htmlspecialchars($doctor['id']) . \"' $selected>\" . htmlspecialchars($doctor['name']) . \"</option>\";\r\n                                            }\r\n                                            ?>\r\n                                        </select>\r\n                                    </form>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div class=\"col-2-5 table-filters pb-0\">\r\n                                <span class=\"table-filter-title\">Tra cứu bệnh nhân </span>\r\n                                <div class=\"filter-container\">\r\n                                    <div class=\"row\">\r\n                                        <div class=\"col-12\">\r\n                                            <input id=\"searchInput\" placeholder=\"Nhập tên hoặc sđt ...\" autocomplete=\"off\"\r\n                                                   class=\"form-control\" value=\"<?php echo $_GET['search'] ?? '' ?>\">\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div class=\"col-2-5 table-filters pb-0\">\r\n                                <span class=\"table-filter-title\">Trạng thái</span>\r\n                                <?php\r\n                                $statusArray = explode(',', $statusAppointment);\r\n                                ?>\r\n                                <div class=\"filter-container\">\r\n                                    <form>\r\n                                        <div class=\"row\">\r\n                                            <div class=\"col-6\">\r\n                                                <div class=\"custom-controls-stacked\">\r\n                                                    <div class=\"custom-control custom-checkbox\">\r\n                                                        <input <?php echo in_array(0, $statusArray) ? 'checked' : ''; ?>\r\n                                                                value=\"0\" class=\"custom-control-input\" id=\"toDo\" type=\"checkbox\">\r\n                                                        <label class=\"custom-control-label\" for=\"toDo\">Chờ xác nhận</label>\r\n                                                    </div>\r\n                                                    <div class=\"custom-control custom-checkbox\">\r\n                                                        <input <?php echo in_array(1, $statusArray) ? 'checked' : ''; ?>\r\n                                                                value=\"1\" class=\"custom-control-input\" id=\"inReview\" type=\"checkbox\">\r\n                                                        <label class=\"custom-control-label\" for=\"inReview\">Đã xác nhận</label>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                            <div class=\"col-6\">\r\n                                                <div class=\"custom-controls-stacked\">\r\n                                                    <div class=\"custom-control custom-checkbox\">\r\n                                                        <input <?php echo in_array(2, $statusArray) ? 'checked' : ''; ?>\r\n                                                                value=\"2\" class=\"custom-control-input\" id=\"inProgress\" type=\"checkbox\">\r\n                                                        <label class=\"custom-control-label\" for=\"inProgress\">Hoàn thành</label>\r\n                                                    </div>\r\n                                                    <div class=\"custom-control custom-checkbox\">\r\n                                                        <input <?php echo in_array(3, $statusArray) ? 'checked' : ''; ?>\r\n                                                                value=\"3\" class=\"custom-control-input\" id=\"done\" type=\"checkbox\">\r\n                                                        <label class=\"custom-control-label\" for=\"done\">Đã hủy</label>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    </form>\r\n                                </div>\r\n                            </div>\r\n                            <div class=\"col-2 table-filters pb-xl-4\">\r\n                                <div class=\"m-0 pt-8\">\r\n                                    <button id=\"button\" class=\"btn btn-success form-control\">Tìm kiếm</button>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"card-body\">\r\n                            <div class=\"noSwipe\">\r\n                                <table class=\"table table-striped table-hover be-table-responsive\" id=\"table1\">\r\n                                    <thead>\r\n                                    <tr>\r\n                                        <th style=\"width:2%;\">STT</th>\r\n                                        <th style=\"width:13%;\">Bác sĩ</th>\r\n                                        <th style=\"width:15%;\">Bệnh nhân</th>\r\n                                        <th style=\"width:12%;\">Thông tin liên hệ</th>\r\n                                        <th style=\"width:10%;\">Chuyên khoa khám</th>\r\n                                        <th style=\"width:10%;\">Thời gian hẹn</th>\r\n                                        <th style=\"width:10%;\" class=\"text-center\">Trạng thái</th>\r\n                                        <th style=\"width:1%;\"></th>\r\n                                    </tr>\r\n                                    </thead>\r\n                                    <tbody>\r\n                                    <?php\r\n                                    $currentPage = $_GET['page'] ?? 1;\r\n                                    $counter = ($currentPage - 1) * 10 + 1;\r\n                                    foreach ($listAppointments as $appointment): ?>\r\n                                        <tr class=\"<?php\r\n                                        switch ($appointment['status']) {\r\n                                            case 0:\r\n                                                echo 'warning in-progress';\r\n                                                break;\r\n                                            case 1:\r\n                                                echo 'primary to-do';\r\n                                                break;\r\n                                            case 2:\r\n                                                echo 'success done';\r\n                                                break;\r\n                                            case 3:\r\n                                                echo 'danger in-review';\r\n                                                break;\r\n                                            default:\r\n                                                echo '';\r\n                                        }\r\n                                        ?>\">\r\n                                            <td style=\"text-align: center\">\r\n                                                <?php echo $counter; ?>\r\n                                            </td>\r\n                                            <td class=\"user-avatar cell-detail user-info\">\r\n                                                <img class=\"mt-0 mt-md-2 mt-lg-0\" src=\"<?php echo htmlspecialchars($appointment['doctor_avt']); ?>\" alt=\"Avatar\">\r\n                                                <span><?php echo htmlspecialchars($appointment['doctor_name']); ?></span>\r\n                                                <!--                                            <span class=\"cell-detail-description\">Bác sĩ chuyên khoa 1</span>-->\r\n                                            </td>\r\n                                            <td class=\"cell-detail milestone\" data-project=\"Bootstrap\">\r\n                                                <span class=\"completed\"><?php echo htmlspecialchars($appointment['patient_dob']); ?></span>\r\n                                                <span class=\"cell-detail-description\"style=\"font-size: 13px; color: black\"><?php echo htmlspecialchars($appointment['patient_name']); ?></span>\r\n                                                <span><?php echo htmlspecialchars($appointment['patient_gender'] == 1 ? 'Nam' : 'Nũ'); ?></span>\r\n                                            </td>\r\n                                            <td class=\"milestone\">\r\n                                                <div><?php echo htmlspecialchars($appointment['patient_phone']); ?></div>\r\n                                                <span class=\"version\"><?php echo htmlspecialchars($appointment['patient_email']); ?></span>\r\n\r\n                                            </td>\r\n                                            <td class=\"cell-detail\">\r\n                                                <span><?php echo htmlspecialchars($appointment['specialty_name']); ?></span>\r\n                                                <!--                                            <span class=\"cell-detail-description\">63e8ec3</span>-->\r\n                                            </td>\r\n                                            <td class=\"cell-detail\">\r\n                                                <span class=\"date\"><?php echo date('H:i', strtotime($appointment['time_slot'])); ?></span>\r\n                                                <span class=\"cell-detail-description\">\r\n                                                <?php\r\n                                                //$appointment['date_slot'] là số ngày kể từ ngày 1/1/1970\r\n                                                $timestamp = $appointment['date_slot'] * 86400; // Chuyển đổi số ngày thành giây\r\n\r\n                                                // Đặt múi giờ sang \"Asia/Ho_Chi_Minh\" để đảm bảo chuyển đổi ngày chính xác theo giờ Việt Nam\r\n                                                date_default_timezone_set('Asia/Ho_Chi_Minh');\r\n\r\n                                                $date = date('d-m-Y', $timestamp); // Định dạng lại timestamp thành ngày tháng\r\n                                                echo htmlspecialchars($date);\r\n                                                ?>\r\n                                                </span>\r\n                                            </td>\r\n                                            <td class=\"text-center\">\r\n                                                <?php\r\n                                                $statusColors = [\r\n                                                    0 => ['#fbbc05', 'Chờ xác nhận'],\r\n                                                    1 => ['#4285f4', 'Đã xác nhận'],\r\n                                                    2 => ['#34a853', 'Đã hoàn thành'],\r\n                                                    3 => ['#ea4335', 'Đã hủy'],\r\n                                                    'default' => ['#d3d3d3', 'Không xác định']\r\n                                                ];\r\n\r\n                                                // Lấy màu và tên trạng thái dựa trên $appointment['status']\r\n                                                $statusInfo = $statusColors[$appointment['status']] ?? $statusColors['default'];\r\n                                                ?>\r\n                                                <div class=\"btn btn-secondary\"\r\n                                                     style=\"width: 150px; color: whitesmoke; font-weight: normal;\r\n                                                             background-color: <?php echo $statusInfo[0]; ?>;\">\r\n                                                    <?php echo $statusInfo[1]; ?>\r\n                                                </div>\r\n                                            </td>\r\n                                            <td>\r\n                                                <div class=\"btn-group\">\r\n                                                    <button id=\"btn-action\"\r\n                                                            style=\"border: none; background-color: transparent; \"\r\n                                                            class=\" dropdown-toggle\" type=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\r\n                                                        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" fill=\"currentColor\" class=\"bi bi-three-dots-vertical\" viewBox=\"0 0 16 16\">\r\n                                                            <path d=\"M3 9.5a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0zm0-5a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0zm0 10a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0z\"/>\r\n                                                        </svg>\r\n                                                    </button>\r\n                                                    <div class=\"dropdown-menu dropdown-menu-right\">\r\n                                                        <a type=\"button\" class=\"dropdown-item\"\r\n                                                           href=\"<?php echo BASE_URL ?>/index.php?controller=appointment&action=detail&id=<?php echo $appointment['id'] ?>\"\r\n                                                           data-id=\"<?php echo $appointment['id'] ?>\">Chi tiết</a>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </td>\r\n                                        </tr>\r\n                                        <?php\r\n                                        $counter++;\r\n                                    endforeach; ?>\r\n                                    </tbody>\r\n                                </table>\r\n                                <div class=\"row be-datatable-footer\">\r\n                                    <div class=\"col-sm-10 dataTables_paginate\" id=\"pagination\" style=\"margin-bottom: 0px!important;\">\r\n                                        <nav aria-label=\"Page navigation example\">\r\n                                            <?php\r\n                                            $currentPage = $_GET['page'] ?? 1;\r\n                                            $queryString = $_SERVER['QUERY_STRING'];\r\n                                            parse_str($queryString, $queryParams);\r\n                                            unset($queryParams['page']);\r\n                                            $newQueryString = http_build_query($queryParams);\r\n\r\n                                            $totalPages = ceil($totalAppointment / 10);\r\n                                            $range = 2; // Số trang hiển thị xung quanh trang hiện tại\r\n                                            $initialNum = $currentPage - $range;\r\n                                            $conditionLimitNum = ($currentPage + $range)  + 1;\r\n                                            ?>\r\n                                            <ul class=\"pagination\">\r\n                                                <li class=\"page-item <?php if ($currentPage == 1) echo 'disabled'; ?>\">\r\n                                                    <a class=\"page-link\" href=\"?<?php echo $newQueryString; ?>&page=1\" aria-label=\"First\">\r\n                                                        <span aria-hidden=\"true\">&lt;&lt;</span>\r\n                                                    </a>\r\n                                                </li>\r\n                                                <li class=\"page-item <?php if ($currentPage == 1) echo 'disabled'; ?>\">\r\n                                                    <a class=\"page-link\" href=\"?<?php echo $newQueryString; ?>&page=<?php echo max(1, $currentPage - 1); ?>\" aria-label=\"Previous\">\r\n                                                        <span aria-hidden=\"true\">&lt;</span>\r\n                                                    </a>\r\n                                                </li>\r\n                                                <?php\r\n                                                if ($initialNum > 1) {\r\n                                                    echo '<li class=\"page-item\"><a class=\"page-link\" href=\"?'.$newQueryString.'&page=1\">1</a></li>';\r\n                                                    if ($initialNum > 2) {\r\n                                                        echo '<li class=\"page-item disabled\"><span class=\"page-link\">...</span></li>';\r\n                                                    }\r\n                                                }\r\n\r\n                                                for ($i = max($initialNum, 1); $i < min($conditionLimitNum, $totalPages + 1); $i++) {\r\n                                                    $activeClass = ($i == $currentPage) ? 'active' : '';\r\n                                                    echo '<li class=\"page-item ' . $activeClass . '\"><a class=\"page-link\" href=\"?'.$newQueryString.'&page=' . $i . '\">' . $i . '</a></li>';\r\n                                                }\r\n\r\n                                                if ($conditionLimitNum < $totalPages + 1) {\r\n                                                    if ($conditionLimitNum < $totalPages) {\r\n                                                        echo '<li class=\"page-item disabled\"><span class=\"page-link\">...</span></li>';\r\n                                                    }\r\n                                                    echo '<li class=\"page-item\"><a class=\"page-link\" href=\"?'.$newQueryString.'&page=' . $totalPages . '\">' . $totalPages . '</a></li>';\r\n                                                }\r\n                                                ?>\r\n                                                <li class=\"page-item <?php if ($currentPage == $totalPages) echo 'disabled'; ?>\">\r\n                                                    <a class=\"page-link\" href=\"?<?php echo $newQueryString; ?>&page=<?php echo min($totalPages, $currentPage + 1); ?>\" aria-label=\"Next\">\r\n                                                        <span aria-hidden=\"true\">&gt;</span>\r\n                                                    </a>\r\n                                                </li>\r\n                                                <li class=\"page-item <?php if ($currentPage == $totalPages) echo 'disabled'; ?>\">\r\n                                                    <a class=\"page-link\" href=\"?<?php echo $newQueryString; ?>&page=<?php echo $totalPages; ?>\" aria-label=\"Last\">\r\n                                                        <span aria-hidden=\"true\">&gt;&gt;</span>\r\n                                                    </a>\r\n                                                </li>\r\n                                            </ul>\r\n                                        </nav>\r\n                                    </div>\r\n                                    <?php\r\n                                    $recordsPerPage = 10;\r\n                                    $currentPage = $_GET['page'] ?? 1;\r\n                                    $totalPages = ceil($totalAppointment / $recordsPerPage);\r\n                                    $startRecord = ($currentPage - 1) * $recordsPerPage + 1;\r\n                                    $endRecord = $currentPage * $recordsPerPage;\r\n                                    if ($endRecord > $totalAppointment) {\r\n                                        $endRecord = $totalAppointment;\r\n                                    }\r\n                                    ?>\r\n                                    <div class=\"col-sm-2 dataTables_info\" id=\"sub-pagination\" style=\"line-height: 48px\">\r\n                                        <?php echo $startRecord . \" đến \" . $endRecord . \" trong số \" . $totalAppointment; ?>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n<?php include 'import-script.php' ?>\r\n<script type=\"text/javascript\">\r\n    $(document).ready(function(){\r\n        document.querySelectorAll('.dropdown-item').forEach(function(button) {\r\n            button.addEventListener('click', function() {\r\n                var appointmentId = this.getAttribute('data-id');\r\n                showAppointmentDetails(appointmentId);\r\n            });\r\n        });\r\n\r\n        function showAppointmentDetails(appointmentId) {\r\n            // Lấy dữ liệu từ server hoặc hiển thị dialog\r\n            console.log('Hiển thị thông tin cho appointment ID:', appointmentId);\r\n            // Code để hiển thị dialog ở đây\r\n        }\r\n        //-initialize the javascript\r\n        App.init();\r\n        App.tableFilters();\r\n    });\r\n</script>\r\n<script>\r\n    var url_appointment = '<?php echo BASE_URL ?>/index.php?controller=appointment&action=index&page=1'\r\n\r\n    document.getElementById('button').addEventListener('click', function() {\r\n    var specialty = document.querySelector('.select2[name=\"specialty\"]').value === 'All'\r\n        ? null\r\n        : document.querySelector('.select2[name=\"specialty\"]').value;\r\n    var doctor = document.querySelector('.select2[name=\"doctor\"]').value === 'All'\r\n        ? null\r\n        : document.querySelector('.select2[name=\"doctor\"]').value;\r\n        var searchInput = document.getElementById('searchInput').value.trim();\r\n    var toDo = document.getElementById('toDo').checked;\r\n    var inReview = document.getElementById('inReview').checked;\r\n    var inProgress = document.getElementById('inProgress').checked;\r\n    var done = document.getElementById('done').checked;\r\n\r\n    var statusAppointment = [];\r\n    if (!toDo && !inReview && !inProgress && !done) statusAppointment = null;\r\n    if (toDo) statusAppointment.push(0);\r\n    if (inReview) statusAppointment.push(1);\r\n    if (inProgress) statusAppointment.push(2);\r\n    if (done) statusAppointment.push(3);\r\n\r\n    if (specialty) {\r\n        url_appointment += '&specialty=' + encodeURIComponent(specialty);\r\n    }\r\n    if (doctor) {\r\n        url_appointment += '&doctor=' + encodeURIComponent(doctor);\r\n    }\r\n    if (searchInput.length > 0) {\r\n        url_appointment += '&search=' + encodeURIComponent(searchInput);\r\n    }\r\n    if (statusAppointment) {\r\n        url_appointment += '&statusAppointment=' + statusAppointment.join(',');\r\n    }\r\n        console.log(url_appointment)\r\n\r\n        window.location.href = url_appointment\r\n    });\r\n\r\n    function getRowClass(status) {\r\n        switch (status) {\r\n            case 0:\r\n                return 'warning in-progress';\r\n            case 1:\r\n                return 'primary to-do';\r\n            case 2:\r\n                return 'success done';\r\n            case 3:\r\n                return 'danger in-review';\r\n            default:\r\n                return '';\r\n        }\r\n    }\r\n\r\n    function formatDate(timestamp) {\r\n        var date = new Date(timestamp * 1000);\r\n        return date.getDate() + '-' + (date.getMonth() + 1) + '-' + date.getFullYear();\r\n    }\r\n\r\n    function formatStatus(status) {\r\n        var statusColors = {\r\n            0: ['#fbbc05', 'Chờ xác nhận'],\r\n            1: ['#4285f4', 'Đã xác nhận'],\r\n            2: ['#34a853', 'Đã hoàn thành'],\r\n            3: ['#ea4335', 'Đã hủy'],\r\n            'default': ['#d3d3d3', 'Không xác định']\r\n        };\r\n        var statusInfo = statusColors[status] || statusColors['default'];\r\n        return '<div class=\"btn btn-secondary\" style=\"width: 150px; color: whitesmoke; font-weight: normal; background-color: ' + statusInfo[0] + ';\">' + statusInfo[1] + '</div>';\r\n    }\r\n\r\n    function convertDateToDayTimestamp(dateString) {\r\n        if (!dateString) return null;\r\n        var parts = dateString.split('/');\r\n        var day = parseInt(parts[0], 10);\r\n        var month = parseInt(parts[1], 10) - 1;\r\n        var year = parseInt(parts[2], 10);\r\n        var date = new Date(Date.UTC(year, month, day));\r\n\r\n        // Chuyển đổi ngày sang timestamp và chia cho số giây trong một ngày\r\n        return Math.floor(date.getTime() / 86400000); // 86400000 là số miligiây trong một ngày\r\n    }\r\n</script>\r\n</body>\r\n</html>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/views/admin/appointments.php b/views/admin/appointments.php
--- a/views/admin/appointments.php	(revision a2a6c48be166dba10eb65bfeb210bf4d3634a9e4)
+++ b/views/admin/appointments.php	(date 1718755478727)
@@ -101,6 +101,7 @@
                             <div class="col-2-5 table-filters pb-0">
                                 <span class="table-filter-title">Trạng thái</span>
                                 <?php
+                                $statusAppointment = $statusAppointment ?? '';
                                 $statusArray = explode(',', $statusAppointment);
                                 ?>
                                 <div class="filter-container">
